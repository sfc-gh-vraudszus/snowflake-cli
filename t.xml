<ns0:Wix xmlns:ns0="http://schemas.microsoft.com/wix/2006/wi">
    <ns0:Product Id="*" Name="Snowflake CLI" Language="1033" Version="$(var.SnowflakeCLIVersion)" Manufacturer="Snowflake, Inc." UpgradeCode="42280567-AE10-4184-8BB4-F98F59519CB2">
        <ns0:Package Id="*" InstallerVersion="405" Compressed="yes" InstallScope="perMachine" Manufacturer="Snowflake, Inc." Platform="x64" />
        <ns0:WixVariable Id="WixUIDialogBmp" Value="scripts\packaging\win\snowflake_msi_background.png" />
        <ns0:WixVariable Id="WixUIBannerBmp" Value="scripts\packaging\win\snowflake_msi_banner.png" />
        <ns0:Media Id="1" Cabinet="snow.cab" EmbedCab="yes" />
        <ns0:MajorUpgrade AllowDowngrades="yes" />
        <ns0:Directory Id="TARGETDIR" Name="SourceDir">
            <ns0:Directory Id="ProgramFiles64Folder" Name="PFiles">
                 <ns0:Directory Id="TESTFILEPRODUCTDIR" Name="Snowflake CLI" />
            </ns0:Directory>
        </ns0:Directory>
        <ns0:DirectoryRef Id="TESTFILEPRODUCTDIR">
            <ns0:Component Id="snow.exe" Guid="3FDE264C-66C4-4B6C-AE4C-F42618FB98BC" Win64="yes">
                <ns0:Environment Id="PATH" Name="PATH" Value="[TESTFILEPRODUCTDIR]" Permanent="no" Part="last" Action="set" System="yes" />
                <ns0:File Id="snow.exe" Source="dist\snow\snow.exe" KeyPath="yes" Checksum="yes" />
            <A attribs="{'id': 1}" /><B attribs="{'id': 2}" /></ns0:Component>
        </ns0:DirectoryRef>
        <ns0:Feature Id="MainApplication" Title="Snowflake CLI" Level="1">
            <ns0:ComponentRef Id="snow.exe" />
        </ns0:Feature>
        <ns0:Icon Id="icon.ico" SourceFile="scripts\packaging\win\snowflake_msi.ico" />
        <ns0:Property Id="ARPPRODUCTICON" Value="icon.ico" />
        <ns0:Property Id="ARPHELPLINK" Value="https://docs.snowflake.net/manuals/user-guide/snowflake-cli.html" />
        <ns0:Property Id="ARPNOMODIFY" Value="yes" Secure="yes" />
        <ns0:Property Id="ARPURLINFOABOUT">https://snowflake.com/</ns0:Property>
        <ns0:Property Id="WIXUI_INSTALLDIR" Value="TESTFILEPRODUCTDIR" />
        <ns0:UIRef Id="WixUI_InstallDir2" />
        <ns0:Property Id="ApplicationFolderName" Value="Snowflake CLI" />
        <ns0:Property Id="WixAppFolder" Value="WixUISupportPerUser" />
        <ns0:CustomActionRef Id="WixBroadcastSettingChange" />
        <ns0:CustomActionRef Id="WixBroadcastEnvironmentChange" />
    </ns0:Product>
    <ns0:Fragment>
        <ns0:UI Id="WixUI_InstallDir2">
            <ns0:TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
            <ns0:TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="12" />
            <ns0:TextStyle Id="WixUI_Font_Title" FaceName="Tahoma" Size="9" Bold="yes" />

            <ns0:Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
            <ns0:Property Id="WixUI_Mode" Value="InstallDir" />
            <ns0:DialogRef Id="BrowseDlg" />
            <ns0:DialogRef Id="DiskCostDlg" />
            <ns0:DialogRef Id="ErrorDlg" />
            <ns0:DialogRef Id="FatalError" />
            <ns0:DialogRef Id="FilesInUse" />
            <ns0:DialogRef Id="MsiRMFilesInUse" />
            <ns0:DialogRef Id="PrepareDlg" />
            <ns0:DialogRef Id="ProgressDlg" />
            <ns0:DialogRef Id="ResumeDlg" />
            <ns0:DialogRef Id="UserExit" />
            <ns0:DialogRef Id="SnowflakeCLIExitDlg" />

            <ns0:Publish Dialog="BrowseDlg" Control="OK" Event="DoAction" Value="WixUIValidatePath" Order="3">1</ns0:Publish>
            <ns0:Publish Dialog="BrowseDlg" Control="OK" Event="SpawnDialog" Value="InvalidDirDlg" Order="4">WIXUI_INSTALLDIR_VALID&lt;&gt;"1"</ns0:Publish>

            <ns0:Publish Dialog="SnowflakeCLIExitDlg" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</ns0:Publish>

            <ns0:Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="InstallDirDlg">NOT Installed</ns0:Publish>
            <ns0:Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg">Installed AND PATCH</ns0:Publish>

            <ns0:Publish Dialog="InstallDirDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg">1</ns0:Publish>
            <ns0:Publish Dialog="InstallDirDlg" Control="Next" Event="SetTargetPath" Value="[WIXUI_INSTALLDIR]" Order="1">1</ns0:Publish>
            <ns0:Publish Dialog="InstallDirDlg" Control="Next" Event="DoAction" Value="WixUIValidatePath" Order="2">NOT WIXUI_DONTVALIDATEPATH</ns0:Publish>
            <ns0:Publish Dialog="InstallDirDlg" Control="Next" Event="SpawnDialog" Value="InvalidDirDlg" Order="3">NOT WIXUI_DONTVALIDATEPATH AND WIXUI_INSTALLDIR_VALID&lt;&gt;"1"</ns0:Publish>
            <ns0:Publish Dialog="InstallDirDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg" Order="4">WIXUI_DONTVALIDATEPATH OR WIXUI_INSTALLDIR_VALID="1"</ns0:Publish>
            <ns0:Publish Dialog="InstallDirDlg" Control="ChangeFolder" Property="_BrowseProperty" Value="[WIXUI_INSTALLDIR]" Order="1">1</ns0:Publish>
            <ns0:Publish Dialog="InstallDirDlg" Control="ChangeFolder" Event="SpawnDialog" Value="BrowseDlg" Order="2">1</ns0:Publish>

            <ns0:Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="InstallDirDlg" Order="1">NOT Installed</ns0:Publish>
            <ns0:Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="MaintenanceTypeDlg" Order="2">Installed AND NOT PATCH</ns0:Publish>
            <ns0:Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg" Order="2">Installed AND PATCH</ns0:Publish>

            <ns0:Publish Dialog="MaintenanceWelcomeDlg" Control="Next" Event="NewDialog" Value="MaintenanceTypeDlg">1</ns0:Publish>

            <ns0:Publish Dialog="MaintenanceTypeDlg" Control="RepairButton" Event="NewDialog" Value="VerifyReadyDlg">1</ns0:Publish>
            <ns0:Publish Dialog="MaintenanceTypeDlg" Control="RemoveButton" Event="NewDialog" Value="VerifyReadyDlg">1</ns0:Publish>
            <ns0:Publish Dialog="MaintenanceTypeDlg" Control="Back" Event="NewDialog" Value="MaintenanceWelcomeDlg">1</ns0:Publish>
        </ns0:UI>
        <ns0:UIRef Id="WixUI_Common" />
    </ns0:Fragment>
</ns0:Wix>